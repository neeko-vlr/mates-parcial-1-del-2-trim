<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master en Geometr√≠a Anal√≠tica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap');
        
        body {
            font-family: 'Outfit', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        /* Colores Modo Claro */
        body.light { background-color: #f0f4f8; color: #1e293b; }
        .light .bg-card { background-color: #ffffff; }
        .light .bg-secondary { background-color: #e2e8f0; }

        /* Colores Modo Oscuro */
        body.dark { background-color: #0f172a; color: #f1f5f9; }
        .dark .bg-card { background-color: #1e293b; }
        .dark .bg-secondary { background-color: #334155; }
        .dark .formula-card { background-color: #334155; color: #f1f5f9; border-left-color: #60a5fa; }
        .dark .text-slate-600 { color: #94a3b8; }
        .dark .text-blue-800 { color: #93c5fd; }
        .dark .bg-blue-50 { background-color: #1e3a8a; color: #dbeafe; }
        .dark .bg-slate-100 { background-color: #334155; }
        .dark .game-canvas-container { background-color: #111827; border-color: #475569; }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .formula-card {
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #3b82f6;
            margin-bottom: 1rem;
        }

        .math-font {
            font-family: 'Times New Roman', Times, serif;
            font-style: italic;
        }

        .quiz-option {
            transition: all 0.2s;
            cursor: pointer;
        }
        .quiz-option:not(.disabled):hover { transform: scale(1.02); }
        .quiz-option.disabled { cursor: default; opacity: 0.7; }
        .quiz-option.correct-ans { border-color: #10b981; background-color: #d1fae5; color: #065f46; }
        .dark .quiz-option.correct-ans { background-color: #065f46; color: #d1fae5; }
        .quiz-option.wrong-ans { border-color: #ef4444; background-color: #fee2e2; color: #991b1b; }
        .dark .quiz-option.wrong-ans { background-color: #991b1b; color: #fee2e2; }
    </style>
</head>
<body class="p-4 md:p-8 light">

    <div class="max-w-5xl mx-auto">
        <!-- Header & Theme Toggle -->
        <header class="relative text-center mb-8">
            <button onclick="toggleDarkMode()" class="absolute right-0 top-0 p-2 rounded-full bg-secondary hover:opacity-80 transition-all">
                <span id="theme-icon">üåô</span>
            </button>
            <h1 class="text-4xl font-bold mb-2">Geometr√≠a Anal√≠tica 1¬∫ Bach</h1>
            <p class="text-slate-600 italic">"Domina el plano, conquista el examen"</p>
        </header>

        <!-- Navigation Tabs -->
        <div class="flex space-x-2 bg-secondary p-1 rounded-xl mb-6">
            <button onclick="showTab('study')" id="tab-btn-study" class="flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-200 active bg-white text-blue-600 shadow-sm">
                üìñ Gu√≠a de Estudio
            </button>
            <button onclick="showTab('game')" id="tab-btn-game" class="flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-200 text-slate-600 hover:bg-slate-300">
                üéÆ Juegos e Interacci√≥n
            </button>
        </div>

        <!-- TAB: STUDY -->
        <div id="study" class="tab-content active space-y-8">
            <!-- Bloque 1: Vectores -->
            <section>
                <h2 class="text-2xl font-bold text-blue-800 mb-4 border-b-2 border-blue-200 pb-2">1. Vectores en el Plano</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="formula-card bg-card">
                        <p class="font-bold text-sm mb-2 text-blue-600">M√≥dulo de un Vector</p>
                        <p class="math-font text-lg text-center bg-blue-50 py-2 rounded">|v| = ‚àö(v‚ÇÅ¬≤ + v‚ÇÇ¬≤)</p>
                    </div>
                    <div class="formula-card bg-card" style="border-left-color: #6366f1;">
                        <p class="font-bold text-sm mb-2 text-indigo-600">Punto Medio de un Segmento</p>
                        <p class="math-font text-lg text-center bg-blue-50 py-2 rounded">M = ( (x‚ÇÅ+x‚ÇÇ)/2 , (y‚ÇÅ+y‚ÇÇ)/2 )</p>
                    </div>
                </div>
            </section>

            <!-- Bloque 2: Producto Escalar y √Ångulos -->
            <section>
                <h2 class="text-2xl font-bold text-green-700 mb-4 border-b-2 border-green-200 pb-2">2. Producto Escalar y Aplicaciones</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="formula-card bg-card" style="border-left-color: #10b981;">
                        <p class="font-bold text-sm mb-2 text-green-600">Producto Escalar</p>
                        <p class="math-font text-lg text-center bg-blue-50 py-2 rounded mb-2">u ¬∑ v = u‚ÇÅv‚ÇÅ + u‚ÇÇv‚ÇÇ</p>
                        <p class="math-font text-lg text-center bg-blue-50 py-2 rounded">u ¬∑ v = |u|¬∑|v|¬∑cos(Œ±)</p>
                    </div>
                    <div class="formula-card bg-card" style="border-left-color: #10b981;">
                        <p class="font-bold text-sm mb-2 text-green-600">√Ångulo entre dos Vectores</p>
                        <p class="math-font text-lg text-center bg-blue-50 py-2 rounded">cos(Œ±) = (u‚ÇÅv‚ÇÅ + u‚ÇÇv‚ÇÇ) / (|u|¬∑|v|)</p>
                    </div>
                </div>
            </section>

            <!-- Bloque 3: Todas las ecuaciones de la recta -->
            <section>
                <h2 class="text-2xl font-bold text-purple-600 mb-4 border-b-2 border-purple-200 pb-2">3. La Recta en el Plano</h2>
                <p class="text-sm mb-4 text-slate-500 italic">Sea P(x‚ÇÄ,y‚ÇÄ) un punto y v(v‚ÇÅ,v‚ÇÇ) el vector director.</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="bg-card p-4 rounded-lg shadow-sm border-t-4 border-purple-500">
                        <p class="font-bold text-xs text-purple-600">Vectorial</p>
                        <p class="math-font text-sm">(x,y) = (x‚ÇÄ,y‚ÇÄ) + t¬∑(v‚ÇÅ,v‚ÇÇ)</p>
                    </div>
                    <div class="bg-card p-4 rounded-lg shadow-sm border-t-4 border-purple-500">
                        <p class="font-bold text-xs text-purple-600">Param√©tricas</p>
                        <p class="math-font text-sm">x = x‚ÇÄ + t¬∑v‚ÇÅ<br>y = y‚ÇÄ + t¬∑v‚ÇÇ</p>
                    </div>
                    <div class="bg-card p-4 rounded-lg shadow-sm border-t-4 border-purple-500">
                        <p class="font-bold text-xs text-purple-600">Continua</p>
                        <p class="math-font text-sm">(x - x‚ÇÄ)/v‚ÇÅ = (y - y‚ÇÄ)/v‚ÇÇ</p>
                    </div>
                    <div class="bg-card p-4 rounded-lg shadow-sm border-t-4 border-purple-500">
                        <p class="font-bold text-xs text-purple-600">Punto-Pendiente</p>
                        <p class="math-font text-sm">y - y‚ÇÄ = m¬∑(x - x‚ÇÄ)</p>
                        <p class="text-[10px] text-slate-400">m = v‚ÇÇ/v‚ÇÅ</p>
                    </div>
                    <div class="bg-card p-4 rounded-lg shadow-sm border-t-4 border-purple-500">
                        <p class="font-bold text-xs text-purple-600">General (Impl√≠cita)</p>
                        <p class="math-font text-sm">Ax + By + C = 0</p>
                        <p class="text-[10px] text-slate-400">Normal n=(A,B) | v=(-B,A)</p>
                    </div>
                    <div class="bg-card p-4 rounded-lg shadow-sm border-t-4 border-purple-500">
                        <p class="font-bold text-xs text-purple-600">Expl√≠cita</p>
                        <p class="math-font text-sm">y = mx + n</p>
                        <p class="text-[10px] text-slate-400">m: pendiente | n: ord. origen</p>
                    </div>
                </div>
            </section>

            <!-- Bloque 4: Distancias y √Ångulos -->
            <section>
                <h2 class="text-2xl font-bold text-red-600 mb-4 border-b-2 border-red-200 pb-2">4. M√©trica y Posiciones Relativas</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="formula-card bg-card" style="border-left-color: #ef4444;">
                        <p class="font-bold text-sm mb-2 text-red-600">Distancia entre dos Puntos A y B</p>
                        <p class="math-font text-lg text-center bg-blue-50 py-2 rounded">d(A,B) = ‚àö((x‚ÇÇ-x‚ÇÅ)¬≤ + (y‚ÇÇ-y‚ÇÅ)¬≤)</p>
                    </div>
                    <div class="formula-card bg-card" style="border-left-color: #ef4444;">
                        <p class="font-bold text-sm mb-2 text-red-600">Distancia Punto P(x‚ÇÄ,y‚ÇÄ) a Recta r</p>
                        <p class="math-font text-lg text-center bg-blue-50 py-2 rounded">d(P,r) = |Ax‚ÇÄ + By‚ÇÄ + C| / ‚àö(A¬≤ + B¬≤)</p>
                    </div>
                </div>
                <div class="mt-4 bg-orange-50 dark:bg-slate-800 p-4 rounded-xl border-l-4 border-orange-400">
                    <p class="font-bold text-orange-700 dark:text-orange-300 mb-2 text-sm">Posiciones Relativas de dos Rectas r y s:</p>
                    <ul class="text-sm space-y-1">
                        <li>‚úÖ <strong>Secantes:</strong> m·µ£ ‚â† m‚Çõ (se cortan en un punto)</li>
                        <li>‚úÖ <strong>Paralelas:</strong> m·µ£ = m‚Çõ y n·µ£ ‚â† n‚Çõ (no se cortan)</li>
                        <li>‚úÖ <strong>Coincidentes:</strong> m·µ£ = m‚Çõ y n·µ£ = n‚Çõ (son la misma)</li>
                        <li class="mt-2 text-red-500 font-bold">‚ö†Ô∏è Perpendiculares: m·µ£ ¬∑ m‚Çõ = -1</li>
                    </ul>
                </div>
            </section>
        </div>

        <!-- TAB: GAME -->
        <div id="game" class="tab-content">
            <!-- Selector de Modo de Juego -->
            <div class="flex justify-center space-x-4 mb-6">
                <button onclick="setGameMode('radar')" id="mode-radar" class="px-6 py-2 rounded-full font-bold bg-blue-600 text-white shadow-lg">Radar Visual</button>
                <button onclick="setGameMode('quiz')" id="mode-quiz" class="px-6 py-2 rounded-full font-bold bg-secondary text-slate-600">Examen Test</button>
            </div>

            <div class="bg-card p-6 rounded-2xl shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h2 id="game-title" class="text-2xl font-bold">El Radar de Vectores</h2>
                    <div id="score" class="text-3xl font-bold text-blue-600">0</div>
                </div>

                <!-- Interfaz Radar (Modo Visual) -->
                <div id="radar-ui" class="bg-slate-100 p-4 rounded-xl mb-4 text-center">
                    <p id="question-text" class="text-xl font-semibold mb-2">Cargando...</p>
                    <div class="flex justify-center space-x-2">
                        <input type="number" id="ans-x" placeholder="X" class="w-20 p-2 border rounded text-center text-black">
                        <input type="number" id="ans-y" placeholder="Y" class="w-20 p-2 border rounded text-center text-black">
                        <button onclick="checkRadarAnswer()" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700">Enviar</button>
                    </div>
                </div>

                <!-- Interfaz Quiz (Modo Test) -->
                <div id="quiz-ui" class="hidden bg-slate-100 p-4 rounded-xl mb-4">
                    <p id="quiz-question" class="text-xl font-semibold mb-4 text-center">Pregunta...</p>
                    <div id="quiz-options" class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4">
                        <!-- Opciones generadas por JS -->
                    </div>
                    
                    <!-- Explicaci√≥n de la soluci√≥n -->
                    <div id="quiz-explanation" class="hidden p-4 rounded-lg bg-white dark:bg-slate-800 border-l-4 border-blue-500 mb-4 transition-all">
                        <p class="font-bold text-blue-600 dark:text-blue-400 mb-1">Procedimiento:</p>
                        <p id="explanation-text" class="text-sm italic"></p>
                    </div>

                    <div class="flex justify-center">
                        <button id="next-question-btn" onclick="initGame()" class="hidden bg-slate-800 text-white px-8 py-2 rounded-full font-bold hover:bg-black transition-all">Siguiente Pregunta ‚Üí</button>
                    </div>
                </div>

                <p id="feedback" class="text-center font-bold h-6 mb-4"></p>

                <div class="game-canvas-container aspect-square md:aspect-video bg-slate-50 flex items-center justify-center">
                    <canvas id="gameCanvas" width="600" height="400" class="max-w-full h-auto"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        let isDarkMode = false;
        let gameMode = 'radar';
        let score = 0;
        let currentProblem = {};
        let canAnswerQuiz = true;
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark', isDarkMode);
            document.body.classList.toggle('light', !isDarkMode);
            document.getElementById('theme-icon').innerText = isDarkMode ? '‚òÄÔ∏è' : 'üåô';
            renderGame();
        }

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            document.querySelectorAll('#tab-btn-study, #tab-btn-game').forEach(btn => {
                btn.classList.remove('bg-white', 'text-blue-600', 'shadow-sm');
                btn.classList.add('text-slate-600');
            });
            
            const activeBtn = document.getElementById('tab-btn-' + tabId);
            activeBtn.classList.add('bg-white', 'text-blue-600', 'shadow-sm');
            activeBtn.classList.remove('text-slate-600');

            if(tabId === 'game') initGame();
        }

        function setGameMode(mode) {
            gameMode = mode;
            document.getElementById('mode-radar').className = mode === 'radar' ? 'px-6 py-2 rounded-full font-bold bg-blue-600 text-white shadow-lg' : 'px-6 py-2 rounded-full font-bold bg-secondary text-slate-600';
            document.getElementById('mode-quiz').className = mode === 'quiz' ? 'px-6 py-2 rounded-full font-bold bg-blue-600 text-white shadow-lg' : 'px-6 py-2 rounded-full font-bold bg-secondary text-slate-600';
            
            document.getElementById('radar-ui').style.display = mode === 'radar' ? 'block' : 'none';
            document.getElementById('quiz-ui').style.display = mode === 'quiz' ? 'block' : 'none';
            document.getElementById('game-title').innerText = mode === 'radar' ? 'El Radar de Vectores' : 'Examen de C√°lculo R√°pido';
            
            initGame();
        }

        function drawGrid() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const step = 40;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            ctx.strokeStyle = isDarkMode ? '#334155' : '#e2e8f0';
            ctx.lineWidth = 1;
            for(let x = 0; x < canvas.width; x += step) {
                ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height); ctx.stroke();
            }
            for(let y = 0; y < canvas.height; y += step) {
                ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke();
            }

            ctx.strokeStyle = isDarkMode ? '#94a3b8' : '#64748b';
            ctx.lineWidth = 2;
            ctx.beginPath(); ctx.moveTo(centerX, 0); ctx.lineTo(centerX, canvas.height); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(0, centerY); ctx.lineTo(canvas.width, centerY); ctx.stroke();
        }

        function toCanvasCoords(x, y) {
            const step = 40;
            return { x: (canvas.width / 2) + (x * step), y: (canvas.height / 2) - (y * step) };
        }

        function drawPoint(x, y, label, color) {
            const pos = toCanvasCoords(x, y);
            ctx.fillStyle = color;
            ctx.beginPath(); ctx.arc(pos.x, pos.y, 6, 0, Math.PI * 2); ctx.fill();
            ctx.font = 'bold 14px Outfit';
            ctx.fillText(label, pos.x + 8, pos.y - 8);
        }

        function initGame() {
            canAnswerQuiz = true;
            document.getElementById('feedback').innerText = "";
            document.getElementById('quiz-explanation').classList.add('hidden');
            document.getElementById('next-question-btn').classList.add('hidden');
            
            if (gameMode === 'radar') generateRadarProblem();
            else generateQuizProblem();
            renderGame();
        }

        function generateRadarProblem() {
            const x1 = Math.floor(Math.random() * 8) - 4;
            const y1 = Math.floor(Math.random() * 6) - 3;
            const x2 = Math.floor(Math.random() * 8) - 4;
            const y2 = Math.floor(Math.random() * 6) - 3;
            currentProblem = { x1, y1, x2, y2, targetX: x2 - x1, targetY: y2 - y1 };
            document.getElementById('question-text').innerText = `Vector AB: A(${x1},${y1}) ‚Üí B(${x2},${y2})`;
        }

        function generateQuizProblem() {
            const u = [Math.floor(Math.random() * 5) + 1, Math.floor(Math.random() * 5) + 1];
            const v = [Math.floor(Math.random() * 5) + 1, Math.floor(Math.random() * 5) + 1];
            const correct = u[0]*v[0] + u[1]*v[1];
            
            const explanation = `Para hallar u ¬∑ v realizamos: (${u[0]} ¬∑ ${v[0]}) + (${u[1]} ¬∑ ${v[1]}) = ${u[0]*v[0]} + ${u[1]*v[1]} = ${correct}.`;
            
            const options = [correct, correct + 2, correct - 3, u[0]*v[1] + u[1]*v[0]].sort(() => Math.random() - 0.5);
            
            currentProblem = { correct, u, v, explanation };
            document.getElementById('quiz-question').innerText = `Producto Escalar: u=(${u[0]},${u[1]}) y v=(${v[0]},${v[1]})`;
            
            const container = document.getElementById('quiz-options');
            container.innerHTML = '';
            options.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = "quiz-option p-4 bg-white dark:bg-slate-700 border-2 border-slate-200 dark:border-slate-600 rounded-xl text-center font-bold hover:border-blue-500 hover:text-blue-500";
                btn.innerText = opt;
                btn.onclick = () => checkQuizAnswer(opt, btn);
                container.appendChild(btn);
            });
        }

        function renderGame() {
            drawGrid();
            if (gameMode === 'radar') {
                drawPoint(currentProblem.x1, currentProblem.y1, 'A', '#3b82f6');
                drawPoint(currentProblem.x2, currentProblem.y2, 'B', '#10b981');
            } else {
                drawPoint(currentProblem.u[0], currentProblem.u[1], 'u', '#3b82f6');
                drawPoint(currentProblem.v[0], currentProblem.v[1], 'v', '#ef4444');
            }
        }

        function checkRadarAnswer() {
            const ux = parseInt(document.getElementById('ans-x').value);
            const uy = parseInt(document.getElementById('ans-y').value);
            const isCorrect = ux === currentProblem.targetX && uy === currentProblem.targetY;
            
            validate(isCorrect);
            if(isCorrect) setTimeout(initGame, 1000);
        }

        function checkQuizAnswer(val, element) {
            if(!canAnswerQuiz) return;
            canAnswerQuiz = false;

            const isCorrect = val === currentProblem.correct;
            
            const options = document.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.classList.add('disabled');
                if(parseInt(opt.innerText) === currentProblem.correct) {
                    opt.classList.add('correct-ans');
                } else if(parseInt(opt.innerText) === val && !isCorrect) {
                    opt.classList.add('wrong-ans');
                }
            });

            document.getElementById('explanation-text').innerText = currentProblem.explanation;
            document.getElementById('quiz-explanation').classList.remove('hidden');
            document.getElementById('next-question-btn').classList.remove('hidden');

            validate(isCorrect);
        }

        function validate(isCorrect) {
            const feedback = document.getElementById('feedback');
            if (isCorrect) {
                score += 10;
                feedback.innerText = "¬°Correcto! +10 puntos";
                feedback.className = "text-center font-bold text-green-500";
            } else {
                feedback.innerText = "Respuesta incorrecta.";
                feedback.className = "text-center font-bold text-red-500";
            }
            document.getElementById('score').innerText = score;
        }

        window.onload = () => { if(window.innerWidth < 640) { canvas.width = 320; canvas.height = 320; } initGame(); };
    </script>
</body>
</html>